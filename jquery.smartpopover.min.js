!function(o){var t;o.smartPopover={version:"0.8"},o.fn.smartPopover=function(r,e){var s=this,a=function(t){t&&t.target&&o(t.target).parents().hasClass("js-smartpopover")||(o(s).removeClass("js-smartpopover-target"),o(s).off("mousemove",E),o(window).off("resize scroll",E),o(s).off("redraw",E),o(document).off("mousedown",a),o(".js-smartpopover").fadeOut(100,function(){o(this).remove()}))};if("destroy"===r)return a(),this;e=e||{};var i=e.always||!0,p=e.arrowsize||12,h=e.arrowwidth||12,d=e.arrowmargin||1,n=e["background-color"]||"#f5f5f5",x=e["background-color2"]||n,w=e["border-radius"]!==t?e["border-radius"]:"4px",l=e["arrow-color"]||n,y=e.margin||{w:24,h:24},b=e.only!==t?e.only:!0,c=e.outerclickclose!==t?e.outerclickclose:!0,f=e.transitionms||0,g="z-index"in e?e["z-index"]:1e4;b&&o(".js-smartpopover-target").smartPopover("destroy"),o(s).addClass("js-smartpopover-target");var m=o("<div/>").addClass("js-smartpopover").css({position:"absolute",left:0,top:0,overflow:"visible","z-index":g}).appendTo("body"),v=o(r).css({position:"absolute",opacity:0}).appendTo(m),u={w:v.width(),h:v.height()};v.hide();var k=o(s).offset(),z=o("<div/>").css({position:"absolute",left:k.left-u.w/2,top:k.top-u.h/2,overflow:"auto",width:u.w+2*y.w,height:u.h+2*y.h,"background-color":n,"border-radius":w,"text-shadow":"1px -1px rgba(0, 0, 0, .1)","box-sizing":"border-box",border:"1px solid rgba(0, 0, 0, .1)","box-shadow":"3px 3px 3px rgba(0, 0, 0, .08), 1px 1px 0 rgba(255, 255, 255, .13) inset","background-image":"linear-gradient("+n+" 0,"+x+" 100%)"}).appendTo(m);v.css({left:y.w,top:y.h,opacity:1}).appendTo(z).show(),u.w=u.w+2*y.w,u.h=u.h+2*y.h;for(var T={w:u.w,h:u.h},j=p+d,C=[],P=[l,"rgba(0, 0, 0, .2)"],I=0;2>I;I++){var L=h+"px solid transparent",O=p+"px solid "+P[I];C[I]={left:{"border-left":O,"border-top":L,"border-bottom":L,"border-right":"",left:-1*j-2+I,top:-1*h},right:{"border-left":"","border-top":L,"border-bottom":L,"border-right":O,left:d+2-I,top:-1*h},bottom:{"border-left":L,"border-top":"","border-bottom":O,"border-right":L,left:-1*h,top:d+2-I},top:{"border-left":L,"border-top":O,"border-bottom":"","border-right":L,left:-1*h,top:-1*j-2+I}}}var Q=o("<div/>").css({position:"absolute","z-index":g+1}).prependTo(m),q=o("<div/>").css({position:"absolute",left:0,top:0,width:0,height:0,"z-index":g+3}).appendTo(Q),A=o("<div/>").css({position:"absolute",left:0,top:0,width:0,height:0,"z-index":g+2}).appendTo(Q),B={},D={};m.hide();var E=function(){k=o(s).offset();var t={x:k.left,y:k.top,w:o(s).width(),h:o(s).height()},r={x:o(window).scrollLeft(),y:o(window).scrollTop(),w:o(window).width(),h:o(window).height()};if(B.x!==t.x||B.y!==t.y||B.w!==t.w||B.h!==t.h||D.x!==r.x||D.y!==r.y||D.w!==r.w||D.h!==r.h){B=t,D=r;var e={left:{x:t.x,y:t.y+t.h/2},right:{x:t.x+t.w,y:t.y+t.h/2},top:{x:t.x+t.w/2,y:t.y},bottom:{x:t.x+t.w/2,y:t.y+t.h}};o.each(e,function(o,t){e[o].x=t.x>r.x+r.w?r.x+r.w:t.x<r.x?r.x:t.x,e[o].y=t.y>r.y+r.h?r.y+r.h:t.y<r.y?r.y:t.y});var a=r.w-T.w>0,i=r.h-T.h>0;u.w=a?T.w:r.w,u.h=i?T.h:r.h,z.css({width:u.w,height:u.h});var p={left:{p:e.left.x-r.x-u.w-j},right:{p:r.x+r.w-e.right.x-u.w-j},top:{p:e.top.y-r.y-u.h-j},bottom:{p:r.y+r.h-e.bottom.y-u.h-j}};p.left.ok=p.left.p>0,p.right.ok=p.right.p>0,p.top.ok=p.top.p>0,p.bottom.ok=p.bottom.p>0;var h=null,d=0;o.each(p,function(o,t){t.ok&&d<t.p&&(h=o,d=t.p)}),null===h&&(d=-9999999,o.each(p,function(o,t){d<t.p&&(h=o,d=t.p)}));var n=e[h],x={};switch(h){case"top":x.x=n.x-u.w/2,x.y=n.y-(u.h+j);break;case"bottom":x.x=n.x-u.w/2,x.y=n.y+j;break;case"left":x.x=n.x-(u.w+j),x.y=n.y-u.h/2;break;case"right":x.x=n.x+j,x.y=n.y-u.h/2}x.y=x.y+u.h>r.y+r.h?x.y-(x.y+u.h-(r.y+r.h)):x.y<r.y?x.y+(r.y-x.y):x.y,x.x=x.x+u.w>r.x+r.w?x.x-(x.x+u.w-(r.x+r.w)):x.x<r.x?x.x+(r.x-x.x):x.x,z.css({left:x.x,top:x.y});var w={};switch(h){case"left":w.x=x.x+u.w+j,w.y=n.y;break;case"right":w.x=x.x-j,w.y=n.y;break;case"top":w.x=n.x,w.y=x.y+u.h+j;break;case"bottom":w.x=n.x,w.y=x.y-j}q.css(C[0][h]),A.css(C[1][h]),Q.css({x:w.x,y:w.y})}};m.fadeIn(100),E(),f>0&&m.css("transition","left "+f+"ms linear 0s, top "+f+"ms linear 0s"),i&&(o(window).on("resize scroll",E),o(document).on("mousemove",E),o(s).on("redraw",E)),c&&o(document).on("mousedown",a)}}(jQuery);